// Description: Prisma file - This is the structure of the database tables.

generator client {
  provider = "prisma-client-js"
}

// To database, it is used PostgreSQL
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Table to Projects
model Project {
  idProject    Int     @default(autoincrement()) @id
  title String  @unique
  description  String?
  stt String?
  submission_date DateTime?
  period DateTime?
  creator_rel Profile? @relation(fields: [creator], references: [id_profile])
  creator Int
  specification String?
  area String?
  role String?
  auth Boolean?
  submission Submission[]
  project_skill Project_skill[]
  project_profile Project_Profile[]
  project_position Project_Position[]
  project_technology Project_Technology[]
  project_team Project_Team[]
}

// Table to Submissions
model Submission {
  id_submission        Int      @default(autoincrement()) @id
  name String?
  id_project_rel    Project?    @relation(fields: [id_project], references: [idProject])
  id_project Int?
  reason String?
  email_rel Profile? @relation(fields: [email], references: [email])
  email String?
  status String?
  position_submission Position_Submission[] 
}

// Table to Profile
model Profile {
  id_profile Int @default(autoincrement()) @id
  name String?
  email String @unique 
  submission Submission[]
  skill_profile Skill_Profile[]
  profile_manager Profile_Manager[]
  project_profile Project_Profile[]
  technology_profile Technology_Profile[]
  project_team Project_Team[]
  project Project[]
}

// Relational table of skills and profiles
model Skill_Profile {
 id Int @default(autoincrement())@id
 id_skill_rel Skill? @relation(fields: [id_skill], references: [id_skill])
 id_skill Int?
 email_rel Profile? @relation(fields: [email], references: [id_profile])
 email Int
}

// Table to skills
model Skill {
  id_skill Int @default(autoincrement()) @id
  skill String? 
  Skill_Profile Skill_Profile[]
  project_skill Project_skill[]
}

// Relational table of skills and projects
model Project_skill {
  id_project_rel Project @relation(fields: [id_project], references: [idProject])
  id_project Int
  id_skill_rel Skill @relation(fields: [id_skill], references: [id_skill])
  id_skill Int

  @@id([id_project, id_skill])
}

// Relational table of projects and profiles
model Project_Profile {
  id_project_rel Project? @relation(fields: [id_project], references: [idProject])
  id_project Int
  id_profile_rel Profile? @relation(fields:[id_profile], references: [id_profile])
  id_profile Int
  @@id([id_project, id_profile])
}

// Relational table of managers and profiles
model Profile_Manager {
  manager_email_rel Manager? @relation(fields: [manager_email], references: [id])
  manager_email Int
  employee_email_rel Profile? @relation(fields: [email], references: [id_profile])
  email Int
  @@id([manager_email, email])
}

//Table to managers
model Manager {
  id Int @default(autoincrement())@id
  email String @unique
  name String
  area String
  manager_email Profile_Manager[]
}

// Relational table of position and submissions
model Position_Submission {
  id_position_rel Position? @relation(fields: [id_position], references: [id_position])
  id_position Int
  id_submission_rel Submission? @relation(fields: [id_submission], references: [id_submission])
  id_submission Int
  @@id([id_position, id_submission])
}

// Relational table of projects and positions
model Project_Position {
  id_project_rel Project? @relation(fields: [id_project], references: [idProject])
  id_project Int
  id_position_rel Position? @relation(fields:[id_position], references: [id_position])
  id_position Int
  @@id([id_project, id_position])
}

// Relational table of projects and technology
model Project_Technology{
  id_project_rel Project? @relation(fields: [id_project], references: [idProject])
  id_project Int
  id_technology_rel Technology? @relation(fields:[id_technology], references: [id_technology])
  id_technology Int
  @@id([id_project, id_technology])
}

// Relational table of project and teams
model Project_Team{
  id_project_rel Project? @relation(fields: [id_project], references: [idProject])
  id_project Int
  id_team_rel Profile? @relation(fields:[email], references: [id_profile])
  email  Int

  @@id([id_project, email])
}

// Relational table of technology and profiles
model Technology_Profile{
  id_technology_rel Technology? @relation(fields: [id_technology], references: [id_technology])
  id_technology Int
  id_profile_rel Profile? @relation(fields:[id_profile], references: [id_profile])
  id_profile Int
  @@id([id_technology, id_profile])
}

// Table to technologies
model Technology{
  id_technology Int @default(autoincrement())@id
  Technology String?
  project_technology Project_Technology[]
  technology_profile Technology_Profile[]
}

// Table to positions
model Position{
  id_position Int @default(autoincrement())@id
  position String?
  position_submission Position_Submission[]
  project_position Project_Position[]
}